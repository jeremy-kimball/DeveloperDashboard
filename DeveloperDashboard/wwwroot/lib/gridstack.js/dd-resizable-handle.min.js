import{isTouch,pointerdown,touchend,touchmove,touchstart}from"./dd-touch";class DDResizableHandle{constructor(e,t,s){this.moving=!1,this.host=e,this.dir=t,this.option=s,this._mouseDown=this._mouseDown.bind(this),this._mouseMove=this._mouseMove.bind(this),this._mouseUp=this._mouseUp.bind(this),this._init()}_init(){const e=document.createElement("div");return e.classList.add("ui-resizable-handle"),e.classList.add(""+DDResizableHandle.prefix+this.dir),e.style.zIndex="100",e.style.userSelect="none",this.el=e,this.host.appendChild(this.el),this.el.addEventListener("mousedown",this._mouseDown),isTouch&&(this.el.addEventListener("touchstart",touchstart),this.el.addEventListener("pointerdown",pointerdown)),this}destroy(){return this.moving&&this._mouseUp(this.mouseDownEvent),this.el.removeEventListener("mousedown",this._mouseDown),isTouch&&(this.el.removeEventListener("touchstart",touchstart),this.el.removeEventListener("pointerdown",pointerdown)),this.host.removeChild(this.el),delete this.el,delete this.host,this}_mouseDown(e){this.mouseDownEvent=e,document.addEventListener("mousemove",this._mouseMove,!0),document.addEventListener("mouseup",this._mouseUp,!0),isTouch&&(this.el.addEventListener("touchmove",touchmove),this.el.addEventListener("touchend",touchend)),e.stopPropagation(),e.preventDefault()}_mouseMove(e){var t=this.mouseDownEvent;this.moving?this._triggerEvent("move",e):2<Math.abs(e.x-t.x)+Math.abs(e.y-t.y)&&(this.moving=!0,this._triggerEvent("start",this.mouseDownEvent),this._triggerEvent("move",e)),e.stopPropagation(),e.preventDefault()}_mouseUp(e){this.moving&&this._triggerEvent("stop",e),document.removeEventListener("mousemove",this._mouseMove,!0),document.removeEventListener("mouseup",this._mouseUp,!0),isTouch&&(this.el.removeEventListener("touchmove",touchmove),this.el.removeEventListener("touchend",touchend)),delete this.moving,delete this.mouseDownEvent,e.stopPropagation(),e.preventDefault()}_triggerEvent(e,t){return this.option[e]&&this.option[e](t),this}}DDResizableHandle.prefix="ui-resizable-";export{DDResizableHandle};